# MS-SQL Database  복사



## 데이터베이스 복사 마법사 사용

출처: https://docs.microsoft.com/ko-kr/sql/relational-databases/databases/use-the-copy-database-wizard?view=sql-server-2017

데이터베이스 복사 마법사는 서버 중단 시간없이 SQL Server의 한 인스턴스에서 다른 인스턴스로 데이터베이스 및 특정 서버 개체를 쉽게 이동하거나 복사합니다. 이 마법사를 사용하여 다음을 수행 할 수 있습니다.

- 원본 및 대상 서버를 선택하십시오.
- 이동하거나 복사 할 데이터베이스를 선택하십시오.
- 데이터베이스의 파일 위치를 지정하십시오.
- 로그인을 대상 서버에 복사합니다.
- 추가 지원 오브젝트, 작업, 사용자 정의 저장 프로 시저 및 오류 메시지를 복사하십시오.
- 데이터베이스를 이동하거나 복사 할시기를 예약하십시오.



## 제한 사항

- Express Edition에서는 데이터베이스 복사 마법사를 사용할 수 없습니다.
- 데이터베이스 복사 마법사를 사용하여 다음과 같은 데이터베이스를 복사하거나 이동할 수 없습니다.
  -  Are System.
  - 복제 대상으로 표시됩니다.
  - 액세스 할 수 없음,로드 중, 오프라인, 복구 중, 의심 됨 또는 응급 모드로 표시됩니다.
  - Microsoft Azure 저장소에 데이터 또는 로그 파일을 저장하십시오.
- FileTables를 사용할 때 마법사는 동일한 디렉토리 이름을 사용하기 때문에 동일한 서버에서 데이터베이스 복사 마법사를 사용할 수 없습니다.
- 데이터베이스를 이전 버전의 SQL Server로 이동하거나 복사 할 수 없습니다.
- 이동 옵션을 선택하면 마법사가 데이터베이스 이동 후 원본 데이터베이스를 자동으로 삭제합니다. 복사 옵션을 선택하면 데이터베이스 복사 마법사는 원본 데이터베이스를 삭제하지 않습니다. 또한 선택한 서버 개체는 대상으로 이동하지 않고 복사됩니다. 데이터베이스는 실제로 이동 된 유일한 오브젝트입니다.
- SQL Server 관리 개체 메서드를 사용하여 전체 텍스트 카탈로그를 이동하는 경우 이동 후 인덱스를 다시 채워야합니다.
- 분리 및 연결 방법은 데이터베이스를 분리하고 데이터베이스 .mdf, .ndf, .ldf 파일을 이동 또는 복사 한 다음 데이터베이스를 새 위치에 다시 연결합니다. 분리 및 접속 방법의 경우, 데이터 유실 또는 불일치를 피하기 위해 활성 세션을 이동 또는 복사중인 데이터베이스에 연결할 수 없습니다. SQL Server 관리 개체 메서드의 경우 데이터베이스가 절대로 오프라인 상태가 아니므로 활성 세션이 허용됩니다.
- 분리 및 연결 방법은 데이터베이스를 분리하고 데이터베이스 .mdf, .ndf, .ldf 파일을 이동 또는 복사 한 다음 데이터베이스를 새 위치에 다시 연결합니다. 분리 및 접속 방법의 경우, 데이터 유실 또는 불일치를 피하기 위해 활성 세션을 이동 또는 복사중인 데이터베이스에 연결할 수 없습니다. SQL Server 관리 개체 메서드의 경우 데이터베이스가 절대로 오프라인 상태가 아니므로 활성 세션이 허용됩니다.
  1. 대상 서버에서 복사 또는 이동할 데이터베이스와 동일한 이름의 셸 데이터베이스를 만듭니다. 데이터베이스 작성을 참조하십시오.
  2. 대상 데이터베이스 구성 페이지에서 동일한 이름의 대상 서버에 모든 데이터베이스 삭제를 선택한 다음 데이터베이스 전송을 계속 진행하고 기존 데이터베이스 파일을 덮어 씁니다.

> 중대한!! 분리 W 접속 메소드를 사용하면 소스 W 목적지 데이터베이스 소유권이 데이터베이스 복사 마} 사를 실행하는 로그인으로 설정됩니다. 데이터베이스의 소유권을 변경하려면 ALTER AUTHORIZATION (Transact-SQL)을 참조하십시오.



## Prerequisites

- SQL Server 에이전트가 대상 서버에서 시작되었는지 확인하십시오.
- 대상 서버에서 원본 서버의 데이터 및 로그 파일 디렉터리에 도달 할 수 있는지 확인하십시오.
- 분리 및 연결 방법에서 원본 서버와 대상 서버의 파일 시스템에 액세스 할 수있는 자격 증명이있는 대상 서버에 SSIS 하위 시스템 용 SQL Server 에이전트 프록시가 있어야합니다. 프록시에 대한 자세한 내용은 SQL Server 에이전트 프록시 만들기를 참조하십시오.

> 중대한!! 분리 및 연결 방법에서 Integration Services 프록시 계정을 사용하지 않으면 복사 또는 이동 프로세스가 실패합니다. 특정 상황에서는 원본 데이터베이스가 원본 서버에 다시 연결되지 않으며 모든 NTFS 보안 사용 권한이 데이터 및 로그 파일에서 제거됩니다. 이 경우 파일로 이동하여 관련 권한을 다시 적용한 다음 데이터베이스를 SQL Server 인스턴스에 다시 연결하십시오.

