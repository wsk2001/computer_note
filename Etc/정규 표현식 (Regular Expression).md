# 정규 표현식 (Regular Expression)

정의: 위키 백과

**정규 표현식**(正規表現式, [영어](https://ko.wikipedia.org/wiki/영어): regular expression, 간단히 regexp[[1\]](https://ko.wikipedia.org/wiki/정규_표현식#cite_note-1) 또는 regex, rational expression)[[2\]](https://ko.wikipedia.org/wiki/정규_표현식#cite_note-Mitkov2003-2)[[3\]](https://ko.wikipedia.org/wiki/정규_표현식#cite_note-Lawson2003-3) 또는 **정규식**(正規式)은 특정한 규칙을 가진 문자열의 집합을 표현하는 데 사용하는 [형식 언어](https://ko.wikipedia.org/wiki/형식_언어)이다. 정규 표현식은 많은 [텍스트 편집기](https://ko.wikipedia.org/wiki/텍스트_편집기)와 [프로그래밍 언어](https://ko.wikipedia.org/wiki/프로그래밍_언어)에서 문자열의 검색과 치환을 위해 지원하고 있으며, 특히 [펄](https://ko.wikipedia.org/wiki/펄)과 [Tcl](https://ko.wikipedia.org/wiki/Tcl)은 언어 자체에 강력한 정규 표현식을 구현하고 있다.

컴퓨터 과학의 [정규 언어](https://ko.wikipedia.org/wiki/정규_언어)로부터 유래하였으나 구현체에 따라서 정규 언어보다 더 넓은 언어를 표현할 수 있는 경우도 있으며, 심지어 정규 표현식 자체의 문법도 여러 가지 존재하고 있다. 현재 많은 [프로그래밍 언어](https://ko.wikipedia.org/wiki/프로그래밍_언어), 텍스트 처리 프로그램, 고급 텍스트 편집기 등이 정규 표현식 기능을 제공한다. 일부는 [펄](https://ko.wikipedia.org/wiki/펄), [자바스크립트](https://ko.wikipedia.org/wiki/자바스크립트), [루비](https://ko.wikipedia.org/wiki/루비_(프로그래밍_언어)), [Tcl](https://ko.wikipedia.org/wiki/Tcl)처럼 문법에 내장되어 있는 반면 [닷넷 언어](https://ko.wikipedia.org/wiki/닷넷_프레임워크), [자바](https://ko.wikipedia.org/wiki/자바_(프로그래밍_언어)), [파이썬](https://ko.wikipedia.org/wiki/파이썬), [POSIX C](https://ko.wikipedia.org/wiki/C_POSIX_라이브러리), [C++](https://ko.wikipedia.org/wiki/C%2B%2B) ([C++11](https://ko.wikipedia.org/wiki/C%2B%2B11) 이후)에서는 [표준 라이브러리](https://ko.wikipedia.org/wiki/표준_라이브러리)를 통해 제공한다. 그 밖의 대부분의 언어들은 별도의 라이브러리를 통해 정규 표현식을 제공한다.

정규 표현식은 [검색 엔진](https://ko.wikipedia.org/wiki/검색_엔진), [워드 프로세서](https://ko.wikipedia.org/wiki/워드_프로세서)와 [문서 편집기](https://ko.wikipedia.org/wiki/문서_편집기)의 찾아 바꾸기 대화상자, 그리고 [sed](https://ko.wikipedia.org/wiki/Sed), [AWK](https://ko.wikipedia.org/wiki/AWK)와 같은 문자 처리 유틸리티, [어휘 분석](https://ko.wikipedia.org/wiki/낱말_분석)에 사용된다.



### 패턴

정규 표현식이라는 문구는 일치하는 텍스트가 준수해야 하는 "패턴"을 표현하기 위해 특정한 표준의 텍스트 신택스를 의미하기 위해 사용된다. 정규 표현식의 각 문자(즉, 패턴을 기술하는 문자열 안의 각 문자)는 [메타문자](https://ko.wikipedia.org/w/index.php?title=메타문자&action=edit&redlink=1)(특별한 의미로)로 이해되거나 정규 문자('문자 그대로', 즉 '리터럴'의 의미로)로 이해된다. 이를테면 정규식 `a.` *a*는 단지 'a'와 일치하는 리터럴 문자이며 *.*는 새 줄을 제외한 모든 문자와 일치시키는 메타 문자이다. 그러므로 이 정규식은 이를테면 'a', 'ax', 'a0'과 일치시킬 수 있다. 더불어, 메타문자와 리터럴 문자는 주어진 패턴의 텍스트를 식별하기 위해 사용할 수 있으며, 또 수많은 인스턴스를 처리하기 위해 사용할 수도 있다. 패턴 일치는 정확히 동일한 일치에서부터 매우 포괄적인 유사 일치(메타문자에 의해 제어)에 이르기까지 다양하다. 이를테면 `.`는 매우 포괄적인 패턴이며, `[a-z]`('a'부터 'z'까지의 모든 문자 일치)는 덜 포괄적이며 `a`는 정확한 패턴(단지 'a'만 일치)이다. 메타문자 문법은 다양한 입력 데이터의 [텍스트 처리](https://ko.wikipedia.org/w/index.php?title=텍스트_처리&action=edit&redlink=1)의 자동화를 지시하는 정확하고 유연한 방법을 통해 표준 [ASCII](https://ko.wikipedia.org/wiki/ASCII) [자판](https://ko.wikipedia.org/wiki/컴퓨터_자판)을 사용하여 입력하기 쉬운 형태로, 미리 기술된 대상을 표현하기 위해 설계되었다.

이러한 신택스를 가지는 매우 단순한 정규 표현식의 경우는 [문서 편집기](https://ko.wikipedia.org/wiki/문서_편집기)에서 2가지 방식으로 발음되는 동일한 단어를 위치시키는 것을 들 수 있으며, 이를테면 `seriali[sz]e`는 "serialise"와 "serialize"를 모두 일치시킨다. [와일드카드](https://ko.wikipedia.org/wiki/와일드카드_문자) 또한 이를 성취할 수 있으나 와일드카드가 패턴화할 수 있는 것으로 국한된다. (메타문자가 더 적으며 더 단순한 언어 기반임)

[와일드카드 문자](https://ko.wikipedia.org/wiki/와일드카드_문자)를 사용하는 경우는 파일 목록에서 비슷한 이름을 [글로브](https://ko.wikipedia.org/wiki/글로브_(프로그래밍)) 처리하는 것인 반면, 정규 표현식은 일반적으로 텍스트 문자열과 패턴 일치가 되는 애플리케이션에 보통 사용된다. 이를테면 `^[ \t]+|[ \t]+$`는 줄 끝이나 줄 맨앞에 여분의 공백을 일치시킨다. 어떠한 숫자라도 일치시키기 위해 쓰이는 진보한 정규 표현식은 `[+-]?(\d+(\.\d+)?|\.\d+)([eE][+-]?\d+)?`이다. 더 많은 예를 보려면 [예](https://ko.wikipedia.org/wiki/정규_표현식#예) 문단을 참고할 것.



### 문법

| 메타문자 | 설명                                                         |
| -------- | ------------------------------------------------------------ |
| .        | 문자	1개의 문자와 일치한다. 단일행 모드에서는 새줄 문자를 제외한다. |
| \        | 이스케이프	특수 문자를 식에 문자 자체로 포함한다.         |
| ¦        | 선택	여러 식 중에서 하나를 선택한다. 예를 들어, "abc¦adc"는 abc와 adc 문자열을 모두 포함한다. |
| ^        | 부정	문자 클래스 안의 문자를 제외한 나머지를 선택한다.<br>예를 들면 `[^abc]`d는 ad, bd, cd는 포함하지 않고 ed, fd 등을 포함한다.<br>`[^a-z]`는 알파벳 소문자로 시작하지 않는 모든 문자를 의미한다 |
| []       | 문자 클래스	"["과 "]" 사이의 문자 중 하나를 선택한다. "¦"를 여러 개 쓴 것과 같은 의미이다.<br>예를 들면 [abc]d는 ad, bd, cd를 뜻한다. 또한, "-" 기호와 함께 쓰면 범위를 지정할 수 있다.<br>"[a-z]"는 a부터 z까지 중 하나, "[1-9]"는 1부터 9까지 중의 하나를 의미한다. |
| ()       | 하위식	여러 식을 하나로 묶을 수 있다. "abc¦adc"와 "a(b¦d)c"는 같은 의미를 가진다. |
| *        | 0회 이상	0개 이상의 문자를 포함한다. "a*b"는 "b", "ab", "aab", "aaab"를 포함한다. |
| +        | 1회 이상	"a+b"는 "ab", "aab", "aaab"를 포함하지만 "b"는 포함하지 않는다. |
| ?        | 0 또는 1회	"a?b"는 "b", "ab"를 포함한다.                  |
| {m}      | m회	"a{3}b"는 "aaab"만 포함한다.                          |
| {m,}     | m회 이상	"a{2,}b"는 "aab", "aaab", "aaaab"를 포함한다. "ab"는 포함되지 않는다. |
| {m, n}   | m회 이상 n회 이하	"a{1,3}b"는 "ab", "aab", "aaab"를 포함하지만, "b"나 "aaaab"는 포함하지 않는다. |
| ^        | 문자열(또는 행)의 처음을 나타낸다.                           |
| $        | 문자열(또는 행)의 끝을 나타낸다.                             |




### 수량자

수량자는 어떤 표현 뒤에 붙여서 그 표현이 얼마나 반복되는지 표시한다.

``` 
*, +, ?, {n} 등. 예를 들어 *는 0개 이상을 의미한다
```



### 문자 클래스

대괄호[]로 묶으며 []안에 있는 것 중 하나랑 일치 하는 패턴을 찾는다.  영문자, 숫자는 - 를 써서 범위를 지정 한다.

| 메타문자 | 설명                                            |
| -------- | ----------------------------------------------- |
| ^        | 부정의 의미를 표시                              |
| &&       | 교집합의 의미를 표시                            |
| \d       | 하나의 숫자. 같은 표현으로 [0-9]                |
| \D       | 하나의 숫자가 아닌 문자. 같은 표현으로` [^0-9]` |
| \s       | 하나의 공백 문자                                |
| \S       | 하나의 공백 문자 이외의 문자                    |
| \w       | 하나의 영숫자                                   |
| \W       | 하나의 영숫자 이외의 문자                       |



### 경계 일치

| 메타문자 | 설명                                                 |
| -------- | ---------------------------------------------------- |
| ^        | 한 행의 시작                                         |
| $        | 한 행의 끝                                           |
| \b       | 단어의 경계                                          |
| \B       | 단어가 아닌 문자의 경계                              |
| \A       | 입력의 시작                                          |
| \G       | 이전 매치의 끝                                       |
| \Z       | 입력의 끝. 그러나, 최종 종결자가 있는 경우 이를 위함 |
| \z       | 입력의 끝                                            |



### 사용 예-1

* C, CPP, java 에서 정규표현식 사용시 \d나 \w 표현은 \\\w, \\\d 형태로 표기할 것

| 예                        | 설명                                |
| ------------------------- | ----------------------------------- |
| [abc]                     | a, b 또는 c                         |
| c[a-z]*                   | c로 시작하는 영어 단어              |
| c[a-z]                    | c로 시작하는 두 글자의 영어 단어    |
| c.                        | c로 시작하는 두 글자의 영어 단어    |
| c.*t                      | c로 시작하고 t로 끝나는 영어 단어   |
| [b\|c].*                  | b 또는 c로 시작하는 영어 단어       |
| [^bc].*                   | b 또는 c로 시작하지 않는 영어 단어  |
| [^abc]                    | a, b 또는 c 이외의 문자(부정)       |
| [a-zA-Z]                  | a~z 또는 A~Z(범위)                  |
| [a-d[m-p]]                | a~d 또는 m~p. [a~dm~p]와 같은 의미. |
| [a-z&&[def]]              | d, e, f (교차)                      |
| [a-z&&`[^bc]`]            | b와 c를 제외하는 a~z (감산)         |
| [a-z&&`[^m-p]`]           | m~p를 제외하는 a~z (감산)           |
| \d{6}-?[1234]\d{6}        | 주민등록번호                        |
| [\\w]+@[\\w]+(\\.[\\w]+)+ | 이메일 주소                         |
| \\d{3}-?\\d{3-4}-?\\d{4}  | 전화번호                            |



### 사용 예-2

| 예                                                           | 설명                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| /^[0-9]+$/                                                   | 숫자만 가능 : [ 0 ~ 9 ] 주의 : 띄어쓰기 불가능               |
| /^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/ | 이메일 형식만 가능                                           |
| /^[가-힣]+$/                                                 | 한글만 가능 : [ 가나다라 ... ] 주의 : ㄱㄴㄷ... 형식으로는 입력 불가능 , 띄어쓰기 불가능 |
| /^[가-힣\s]+$/                                               | 한글,띄어쓰기만 가능 : [ 가나다라 ... ] 주의 : ㄱㄴㄷ... 형식으로는 입력 불가능 , 띄어쓰기 가능 |
| /^[a-zA-Z]+$/                                                | 영문만 가능 :                                                |
| /^[a-zA-Z\s]+$/                                              | 영문,띄어쓰기만 가능                                         |
| /^[0-9]{2,3}-[0-9]{3,4}-[0-9]{4}$/                           | 전화번호 형태 : 전화번호 형태 000-0000-0000 만 받는다. ]     |
| /^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]{2,6}(\:[0-9]+)?(\/\S*)?$/ | 도메인 형태, http:// https:// 포함안해도 되고 해도 되고      |
| /^((http(s?))\:\/\/)([0-9a-zA-Z\-]+\.)+[a-zA-Z]{2,6}(\:[0-9]+)?(\/\S*)?$/ | 도메인 형태, http:// https:// 꼭 포함                        |
| /^[^((http(s?))\:\/\/)]([0-9a-zA-Z\-]+\.)+[a-zA-Z]{2,6}(\:[0-9]+)?(\/\S*)?$/ | 도메인 형태, http:// https:// 포함하면 안됨                  |
| /^[가-힣a-zA-Z]+$/;                                          | 한글과 영문만 가능                                           |
| /^[a-zA-Z0-9]+$/;                                            | 숫자,알파벳만 가능                                           |

/^(?:[0-9]{2}(?:0[1-9]|1[0-2])(?:0[1-9]|[1,2][0-9]|3[0,1]))-[1-4][0-9]{6}$/ : 주민번호, -까지 포함된 문자열로 검색



###  정규 표현식의 기본 문법

정규 표현식은 소프트웨어에 따라서 방식이나 지원 범위가 다를 수 있습니다.

```
^The			The로 시작하는 문자열
of despair$		of despair로 끝나는 문자열
^abc$			abc로 시작하고 abc로 끝나는 문자열 (abc 라는 문자열도 해당됨)
notice			notice가 들어 있는 문자열


ab*				a 다음에 b가 0개 이상 (a, ab, abbb 등등)
ab+				a 다음에 b가 1개 이상 (ab, abbb 등등)
ab?				a 다음에 b가 있거나 없거나 (ab 또는 a)


ab{2}			a 다음에 b가 2개 있는 문자열 (abb)
ab{2,}			a 다음에 b가 2개 이상 (abb, abbbb 등등)
ab{3,5}			a 다음에 b가 3개에서 5개 사이 (abbb, abbbb, 또는 abbbbb)
*, +, ?는 각각 {0,}, {1,}, {0,1}과 같습니다.


( )는 문자열을 묶음 처리할 때 사용
a(bc)*			a 다음에 bc가 0개 이상 (묶음 처리)
a(bc){1,5}		a 다음에 bc가 1개에서 5개 사이


hi|hello		hi나 hello가 들어 있는 문자열
(b|cd)ef		bef 또는 cdef
(a|b)*c			a와 b가 섞여서 여러번 나타나고 그뒤에 c가 붙어있는 패턴


. (점)			임의의 한 문자
^.{3}$			3문자로만 되어 있는 문자열


[ ]	괄호 안에 있는 내용 중 임의의 한 문자
[^ ]			첫문자로 ^를 쓰면 괄호 내용의 부정. 즉 괄호 안에 포함되지 않는 한 문자
[ab]			a 또는 b (a|b 와 동일한 표현)
[a-d]			소문자 a에서 d까지 (a|b|c|d 또는 [abcd] 와 동일)
^[a-zA-Z]		영문자로 시작하는 문자열
[0-9]%			% 문자 앞에 하나의 숫자가 붙어 있는 패턴
%[^a-zA-Z]%		두 % 문자 사이에 영문자가 없는 패턴


특수 문자 자체를 검색하기 및 사용하기
\^	^	\.	.
\[	[	\$	$
\(	(	\)	)
\|	|	\*	*
\+	+	\?	?
\{	{	\\	\
\n	줄넘김 문자	\r	리턴 문자
\w	알파벳과 _ (언더바)	\W	알파벳과 _ 가 아닌 것
\s	빈 공간(space)	\S	빈 공간이 아닌 것
\d	숫자	\D	숫자가 아닌 것
\b	단어와 단어 사이의 경계	\B	단어 사이의 경계가 아닌 것
\t	Tab 문자	\xnn	16진수 nn에 해당하는 문자
[ ] 안에서는 특수 문자가 모두 효력을 잃게 됩니다.


검색 + 치환을 위한 하부식(부분식)
( )로 둘러싼 부분은 각각 하나의 덩어리로 취급해서,
검색시 ( ) 안에 해당되는 내용들을 변경할 내용에서 그대로 가져다 이용할 수 있습니다.
검색된 각각의 ( )안에 해당되는 내용은 변경할 내용에서 $1, $2, .. 등으로 지정해서 쓸 수 있습니다.
예제) mp3파일 이름 바꾸기
검색 : (.*) - (.*)\.mp3 .*은 길이에 상관없이 임의의 문자열, \.은 점
치환 : $2 - $1.mp3 앞에서 검색한 ( )안에 해당되는 내용끼리 순서 바꾸기
ex) "제목 - 연주자.mp3" Þ "연주자 - 제목.mp3"
앞에서 정의한 하부식을 다시 활용하기 (제가 잘못 이해한 것일 수도 있는데)
\n은 ( ) 하부식 중에서 n번째 하부식을 가리킵니다.
예제) (.+)\1+
\1로 되어 있으니까 첫번째 부분식 (.+)를 가리킵니다. 위 내용을 해석하자면, 일단 (.+)가 있으니까 이에 해당되는 내용을 찾고, \1+이 있으니까 첫번째 부분식 (.+)와 똑같은 내용이 그 뒤에 1번 이상 있는 문자열을 찾습니다.
예제) abab같은 문자열이 위에 해당되는데, 일단 (.+) 즉 임의의 문자열 ab를 찾고 그 뒤에 \1+로 첫번째 부분식을 다시 1번 이상 있는 것을 찾으니까 뒤의 ab가 이에 해당합니다.


변경자 ? 검색 방식 변경
(?i)			대소문자 무시 (기본값)
(?-i)			대소문자 구분
(?g)			"greedy" 모드로 전환 (기본값)
(?-g)			"greedy" 모드 해제, 따라서 "+"는 "+?"과 동일한 것으로 인식

```



c++ 정규 표현식 참조 : https://modoocode.com/303

문자열 치환 소스 (replaceAll.c)

리턴 받은 결과 값이 NULL 이 아니고 문자열 길이가 0 보다 크면  함수를 호출한 쪽 에서 사용 후 memory 를 free 해 주어야 한다.

```c
char *replaceAll(char *s, const char *olds, const char *news) 
{
  char		*result, *sr;
  size_t	i, count = 0;
  size_t	oldlen   = strlen(olds); 
  size_t	newlen   = strlen(news);

  if (oldlen < 1) return s;			

  if (newlen != oldlen) 
  {
    for (i = 0; s[i] != '\0';) 
	{
      if (memcmp(&s[i], olds, oldlen) == 0) count++, i += oldlen;
      else i++;
    }
  } 
  else i = strlen(s);

  result = (char *) malloc(i + 1 + count * (newlen - oldlen));
  if (result == NULL) return NULL;

  sr = result;
  while (*s) {
    if (memcmp(s, olds, oldlen) == 0) {
      memcpy(sr, news, newlen);
      sr += newlen;
      s  += oldlen;
    } else *sr++ = *s++;
  }
  *sr = '\0';

  return result;
}

```



여러 조건의 문자열을 검색 할 경우 문자열 길이가 긴 쪽의 패턴을 우선 검사 하도록 한다.

